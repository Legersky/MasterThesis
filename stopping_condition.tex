\begin{lem}
The following statements are equivalent:
\begin{enumerate}[i)]
	\item Phase 2 does not converge,
	\item $\forall \,k\in \NN \,\exists\, \tupleo{k}\in\B^{k+1} \colon \#\Qwo{k}\geq 2$,
	\item $\exists \,(w_{-k})_{k\geq 0}, w_{-k}\in\B \,\exists\, k_0\forall k\geq k_0 \colon \#\Qwo{k}=\#\Qwo{(k-1)}\geq 2$.
\end{enumerate}
\begin{proof}
\textit{i)}$\iff$\textit{ii):} The while loop in Algorithm~\ref{alg:weightFunction} ends if and only if there exist $k\in\NN$ such that $\#\Qwo{k}=1$ for all $\tupleo{k}\in\B^{k+1}$.

\textit{ii)}$\iff$\textit{iii):} There is an infinite sequence $(w_{-k})_{k\geq 0}$ such that $\#\Qwo{k}\geq 2$ for all $k\in\NN$ since $\Qwo{k}\supset\Qwo{(k+1)}$. Hence, the sequence of integers $(\#\Qwo{k})_{k\geq 0}$ is eventually constant. The opposite implication is trivial.
\end{proof}
\end{lem}

\begin{defn}
Let $\B$ be an alphabet of input digits. We say that Phase 2 is \emph{stable}, if the following conditions on the sets of possible weight coefficients which are produced by the algorithm hold: 
\begin{enumerate}[i)]
	\item $\#\Qw{1}{k}=1 \implies \#\Qwo{k}=1$,
	\item $\Qw{1}{k}=\Qw{1}{(k+1)} \implies \Qwo{k}=\Qwo{(k+1)}$
\end{enumerate}
for all $k\in\NN$ and for all $\tupleo{(k+1)} \in \B^{k+2}$.
\end{defn}

\komentar{okomentovat, co to znamena}

\begin{defn}
Let $\B$ be an alphabet of input digits. Let Phase 2 is stable. Let $k\in\NN, k\geq 2$. We set
$$
V:=\left\{\tuple{1}{k}\in\B^k\} \colon \#\Qw{1}{k}=\#\Qw{1}{(k-1)}\right\}
$$
and
$$
E:=\left\{\tuple{1}{k}\rightarrow\tuple[w']{1}{k}\in V\times V \colon \tuple{2}{k}=\tuple[w']{1}{(k-1)}\right\}\,.
$$
The oriented graph $G_k=(V,E)$ is called \emph{Rauzy graph of Phase 2 (for the window of length~$k$)}.
\end{defn}

\begin{thm}
Let Phase 2 is stable. If there exist $k\in\NN, k\geq 2$ such that
\begin{enumerate}[i)]
	\item $\exists \tupleo{k}\in\B^{k+1}$ such that $\#\Qwo{k}>1$ and
	\item there exist an infinite walk $(\tuple[w^{(i)}]{1}{k})_{i\geq 0}$ in $G_k$ which starts with the edge $$\tupleo{(k-1)}\rightarrow\tuple{1}{k}\,,$$ where $G_k$ is the Rauzy graph of Phase 2 for the window of length $k$,
\end{enumerate}
then Phase 2 does not converge.
\end{thm}