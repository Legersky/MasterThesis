We attempted to find a parallel addition algorithm for more than 5000 different numeration systems. Including various methods in Phase~1 and 2, the implementation of the extending window method was launched over 7000 times. 

Only expanding bases were considered as it is a necessary condition for convergence of the extending window method. At the same time, convergence of Phase~1 is guaranteed. We take an input alphabet $\B$ equal to $\A+\A$.

Most of the bases were given by polynomial combinations of $\omega$ with coefficients in a limited range, where $\omega$ was generated as a root of a monic polynomial with bounded integer coefficients. Mostly, $\omega$ were  quadratic, but cubic ones were also tested. Alphabets for these bases were generated automatically according to Section~\ref{sec:alphabetGeneration}.

Besides that, the extending window method was run for selected numeration systems in order to compare different methods in Phase~1 and 2, see  Section~\ref{sec:compareMethods}.

Processing such a number of inputs is enabled by the developed criteria of non-convergence of Phase~2. The control of $bb\dots b$ inputs often reveals non-convergence very quickly, while an infinite loop in Phase~2 is avoided due to check of directed cycles in a Rauzy graph. This condition seems to be really strong -- so far we have only four examples which were interrupted because of lack of memory before non-convergence was revealed or a weight function found. We discuss them later.

Altogether, a parallel addition algorithm was found for about 140
% cases. A possible explanation of such low success rate is the automatic construction of alphabets -- there may exist  alphabets which are better spread or more symmetric. Another reason is that we did not have enough computational power for testing with various methods in Phase~1 and 2:  different methods are more suitable for different numeration systems, as we will see in Section~\ref{sec:compareMethods}.
%Nevertheless, we provide various successful examples of 
numeration systems with integer and non-integer alphabets. Some of them are listed in Section~\ref{sec:resultsExamples}.

In Section~\ref{sec:gspreadsheet}, we describe Google spreadsheet \href{https://docs.google.com/spreadsheets/d/1TnhrHdefHfHa0WSeVs4q6XVj3epjPlPlnoekE0E1xeM/edit?usp=sharing}{ParallelAddition\_results} which contains all tested inputs.

\afterpage{
\clearpage   % To flush out all floats, might not be what you want
\begin{landscape}
	\begin{table}[htbp]
		%\begin{adjustwidth}{-2cm}{}
		\begin{center}
		\input{resultsPhaseOne.tex}		
		\end{center}		
		%\end{adjustwidth}
	\caption{Comparing methods in Phase 1}
	\label{tab:resultsPhaseOne}
	\end{table}
\end{landscape}
%}
%
%\afterpage{
%\clearpage   % To flush out all floats, might not be what you want
\begin{landscape}
	\begin{table}[h]
	\vspace{-0.5cm}
%	\begin{adjustwidth}{-3cm}{}
\begin{center}
		\input{resultsPhaseTwo.tex}
	\caption{Comparing methods in Phase 2}
	\label{tab:resultsPhaseTwo}
	\end{center}
%	\end{adjustwidth}
	\thispagestyle{empty}
	\end{table}
\end{landscape}
}


\section{Comparing different choices in Phase 1 and 2}
\label{sec:compareMethods}

As we mentioned, both phases of the extending window method are significantly dependent on the way of extending $\Q_k$ to $\Q{k+1}$ , respectively choice of $\Qwo{k}$ from $\Qwo{(k-1)}$. Various methods were designed and implemented. They were all tested on the numeration systems which are listed in Table~\ref{tab:resultsPhaseOne}. Parallel addition algorithms were found manually~\cite{milena} for some of them, for instance Eisenstein\_1--block\_complex, Penney\_1--block\_complex, Penney\_2--block\_integer or Quadratic+1+4+5\_complex2. 

The methods 1a, 1b, 1c, 1d and 1e, resp. 2a, 2b, 2c, 2d and 2e, which are described in Chapter~\ref{chap:diffChoices}, were selected as they represent groups of methods which seems to behave similarly from our experience with many preliminary tests. Moreover, if a parallel addition algorithm was found for a numeration system in a preliminary test, then at least one successful method is contained in the selection.



\begin{table}[htb]
	\begin{center}
	\input{alphabets.tex}
	\end{center}
\caption{Alphabets for numeration systems in Table~\ref{tab:resultsPhaseOne} and \ref{tab:resultsPhaseTwo}}
\label{tab:alphabets}
\end{table}





Let us explain Tables~\ref{tab:resultsPhaseOne}, \ref{tab:resultsPhaseTwo} and \ref{tab:alphabets}. Each row in Table~\ref{tab:resultsPhaseOne} represents one numeration system with a base $\beta\in\Zomega$ for a given algebraic integer $\omega$. The column \emph{conj.} signifies whether the base $\beta$ has a real conjugate greater than 1. The sizes of alphabets are listed and the column \emph{min.} says if the alphabets, which are listed in Table~\ref{tab:alphabets}, are minimal in the sense of the lower bound given by Theorem~\ref{thm:lowerBoundAlphabet}.  We remark that the size of an alphabet is compared with the bound regardless to working in $\Zbeta$ or $\Zomega$. 
In the last columns, there are the sizes of weight coefficients sets $\Q$ which were found  with various methods of Phase~1.

The results of Phase~2 for the selected numeration systems are shown in Table~\ref{tab:resultsPhaseTwo}. More rows for one numeration system correspond to distinct weight coefficients sets from Phase~1. The column $bb\dots b$ says whether check of $bb\dots b$ inputs was successful. If a weight function is found, it is denoted by \checkmark{} in the column \emph{Ph.2} and the length of window is in the column $r$. Symbol \xmark{} in the column \emph{Ph.2} means that a cycle in a Rauzy graph was found, i.e., Phase~2 does not converge. Reasons for non-convergence (digits $b$ or a cycle in Rauzy graph) can be recognized in the  example given by the last column in Appendix~\ref{app:examples}.

We remark that Lemma~\ref{lem:suffCondPhase1} instead of some method of Phase~1 means that the set given by this lemma was used as $\Q$ instead of a computed one.  We see that the smaller weight coefficients set $\Q$ does not mean automatically better (Quadratic+1+4+5 \_complex1 or Quadratic+1+3+4\_complex). An observation for many numeration systems is that if the extending window method is successful, then weight coefficients sets produced by different methods are similar. But it is not a rule. 

Unfortunately, there is also no best method for Phase~2. For example, method 2e is successful for all selected quadratic bases, but it fails for the cubic ones. Moreover, the length of window $r$ is not always minimal (Quadratic+1+0--5\_integer). On the other hand, the method 2d is the only one which finds a weight function for cubic bases, but it fails in many other cases. The method 2b seems to be often successful, but not with the optimal length of window.

An interesting example is Quadratic+1+4+5\_complex1. Only one element of the alphabet is different, comparing with Quadratic+1+4+5\_complex2. Whereas a weight function is easily found for Quadratic+1+4+5\_complex2 by all methods, the only successful combination of methods for Quadratic+1+4+5\_complex1 is the weight coefficients set given by Lemma~\ref{lem:suffCondPhase1} and method 2e. We remark that many of elements of such $\Q$ are not used as outputs of the obtained weight function. Notice   that there are only few inputs digits $b$ such that  Quadratic+1+4+5\_complex1 fails in the check of $bb\dots b$ inputs in Example~\ref{ex:compareAP}.





\section{Examples of results}
\label{sec:resultsExamples}
We divide numeration systems with quadratic base according to the type of  alphabet. Numeration systems with non-integer alphabets are in Table~\ref{tab:resultsQuadrNonint}, while numeration systems with integer alphabets are in Table~\ref{tab:resultsQuadrInt}. The structure of tables is the same as in the previous section. The methods 1d for Phase~1 and 2b for Phase~2 were used for the listed numeration systems.

\begin{table}[tpb]
	\begin{center}
	\input{results_quadr_nonint.tex}
	\end{center}
\caption{Quadratic bases with a non-integer alphabet (using methods 1d and 2b)}
\label{tab:resultsQuadrNonint}
\end{table}

Firstly, we focus on non-integer alphabets. Since many alphabets are large, Table~\ref{tab:resultsQuadrNonint} outlines only their sizes. The whole alphabets can be found in the spreadsheet \href{https://docs.google.com/spreadsheets/d/1TnhrHdefHfHa0WSeVs4q6XVj3epjPlPlnoekE0E1xeM/edit?usp=sharing}{ParallelAddition\_results}, see Section~\ref{sec:gspreadsheet}.

Note that none of the bases has a real conjugate greater than 1. Observe that the linear and absolute coefficients of the minimal polynomial $m_\beta$ are positive if the corresponding alphabet attains the lower bound given by Theorem~\ref{thm:lowerBoundAlphabet}. A possible explanation is that if a linear coefficient was negative, then $\#\A=m_\beta(0)\geq m_\beta(1)$, i.e., the numeration system would not be redundant  enough.

Parallel addition algorithms can be found for quite large alphabets  if the final length of window is small or many combinations of input digits  are saved for a shorter window than the final one. Examples~\ref{ex:killAB} and \ref{ex:killAA} in Appendix~\ref{app:examples} are the only inputs with quadratic base which were interrupted because of the exponential growth of memory requirement.

 
\begin{table}[htpb]
	\begin{center}
	\input{results_quadr_int.tex}
	\end{center}
\caption{Quadratic bases with an integer alphabet (using methods 1d and 2b)}
\label{tab:resultsQuadrInt}
\end{table}

Table~\ref{tab:resultsQuadrInt} shows some examples of numeration systems with integer alphabets for which the extending window method was successful. The alphabets are of the form $\{-a, -a+1, \dots, -1,0,1,\dots, a-1,a\}$ or $\{-a+1, \dots, -1,0,1,\dots, a-1,a\}$, depending on the parity of their size, where $a$ is a positive integer.

As we mentioned in Section~\ref{sec:minimalAlphabet}, congruences behave differently in $\Zbeta$ and $\Zomega$. The alphabets divided into congruence classes modulo $\beta$ and $\beta-1$ in $\Zomega$ for some of the numeration systems can be found in Examples \ref{ex:integerAB} -- \ref{ex:integerAR} in Appendix~\ref{app:examples}. However, we recall that if $\beta=\pm \omega+c$  for some $c\in\ZZ$, then $\Zbeta=\Zomega$. 

We made the following observations:
\begin{enumerate}
\item The congruence classes modulo $\beta-1$ in Examples \ref{ex:integerAJ} and \ref{ex:integerAK} are different, since we work in $\ZZ\left[\frac{1}{2} \sqrt{5} + \frac{1}{2}\right]$ for the former and in $\ZZ\left[-\sqrt{5} + 1\right]$ for the latter one.
\item If $\Zbeta\neq\Zomega$, then an alphabet may not contain representatives of all congruence classes modulo $\beta-1$ in $\Zomega$, see Examples \ref{ex:integerAB},  \ref{ex:integerAJ}, \ref{ex:integerAO} and \ref{ex:integerAR}.
\item The division of the alphabet into congruence in Example \ref{ex:integerAE} is the same modulo $\beta$ and $\beta-1$.
\item If an alphabet is minimal, there is only one congruence class modulo $\beta$ which has two representatives in the alphabet, i.e, it is only a little  redundant.
\item If a base has a real conjugate greater than one, then the alphabet contains one more element congruent to the smallest and greatest digit modulo $\beta-1$ as it is necessary according to Lemma~\ref{lem:alphabetRestrictions}.
\item Examples \ref{ex:integerAB} and \ref{ex:integerAO} show that  an alphabet with one more digit than the minimal number of digits has shorter length of window.
\item The weight coefficients set $\Q$ has size 9 for all successful numeration systems with integer alphabets.
\end{enumerate}


We remark that we have no example of a base for which the extending window method converges with integer and also non-integer alphabet. We are aware of the fact that Theorem~\ref{thm:suffConjugates} provides a parallel addition algorithm with an integer alphabet for an expanding base, but  a different rewriting rule than $x-\beta$ is used.



We tested also about 230 cubic bases, but the only successful inputs are in Table~\ref{tab:resultsPhaseOne}. There are only two more examples (\ref{ex:killAC} and \ref{ex:killAD}) when the check of $bb\dots b$ inputs was successful. Unfortunately, the computations were interrupted before non-convergence by a Rauzy graph was revealed or a weight function found. Both were interrupted having the length of window 3 processed, but the final length of window would be at least 5, resp., 6 according to the lenght of window for $bb,\dots,b$ inputs.








\section{Google spreadsheet ParallelAddition\_results}
\label{sec:gspreadsheet}
All results can be found in the spreadsheet \href{https://docs.google.com/spreadsheets/d/1TnhrHdefHfHa0WSeVs4q6XVj3epjPlPlnoekE0E1xeM/edit?usp=sharing}{ParallelAddition\_results}. Its structure is the following -- the worksheet \verb+results+ is used for automatically saved results. Some results were copied to \verb+results_archive+ to reduce the number of rows in \verb+results+. The meaning of each column is obvious from the heading line.

The worksheet \verb+inputs+ serves for loading inputs by the script \verb+ewm_gspreadsheet.sage+. The numeration systems for which a weight function was successfully found are in the worksheet \verb+successful+. We remark that they are listed with a single combination of methods for Phase~1 and 2. Nevertheless, all tested variants remain in \verb+results+ and \verb+results_archive+. 

Results for selected numeration systems which were tested with various  methods for Phase~1 and 2 are sorted in the worksheet \verb+comparePhase2+. Note that if the result of Phase~1 is the same for more methods, then only one of them is used for testing of methods for Phase~2. This fact can be found in the columns \emph{Groups of methods with the same result} and \emph{Sizes of weight coefficients sets for groups} in the worksheet \verb+comparePhase1+. For instance, the values \verb+[['1a'], ['1b', '1c', '1d', '1e']]+ and \verb+[19, 17]+ mean that Phase~1 with method 1a produces a weight coefficients set $\Q$ of size 19, while methods 1b, 1c, 1d and 1e outputs the same weight coefficients set $\Q$ of size 17.
Very useful property of storing data in a worksheet is easy sorting and filtering.

The version of \href{https://docs.google.com/spreadsheets/d/1TnhrHdefHfHa0WSeVs4q6XVj3epjPlPlnoekE0E1xeM/edit?usp=sharing}{ParallelAddition\_results} which is on the attached DVD was downloaded on May 4, 2016.
