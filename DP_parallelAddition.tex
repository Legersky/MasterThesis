\documentclass[11pt,a4paper]{report}	%,twoside,openright
%git-latexdiff 17807bf54f868 --main DP_parallelAddition.tex --cleanup none --latex



\usepackage{a4wide,cite}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
% \usepackage[IL2]{fontenc}  
% \usepackage{amsmath,amsthm} 
% \usepackage{amsfonts}


\usepackage[fixlanguage]{babelbib}
\selectbiblanguage{english}



% fix left/right margins
%\let\tmp\oddsidemargin
%\let\oddsidemargin\evensidemargin
%\let\evensidemargin\tmp
%\reversemarginpar

\input{commands.tex}    
\newtheorem{thm}{Theorem}[chapter]
\newtheorem{lem}[thm]{Lemma}

\theoremstyle{definition}
\newtheorem{defn}{Definition}[chapter]
\newtheorem{exmp}{Example}[chapter]

\begin{document}
\tableofcontents
\input{symbols.tex}

\chapter*{Introduction}
Parallel addition have been studied as it is an important part of algorithms for multiplication and division. 
While carry propagation in the standard algorithms requires to compute digits of the sum of $x_n x_{n-1}\cdots x_1 x_0 \bullet$ and $y_n y_{n-1}\cdots y_1 y_0 \bullet$  one by one, a parallel algorithm determines the $j$-th digit of the sum just from the knowledge of fixed number of digits around $x_j$ and $y_j$. Thus it avoids the carry propagation and all digits digits of the result can be outputted at the same time. Besides theoretical reasons, parallel addition is used for instance in fast division algorithm in processors Pentium which is implemented in a numeration system with base 4 and digits $\{-2,-1,0,1,2\}$.

A parallel addition algorithm  was introduced by A. Avizienis in \cite{avizienis} in 1961. The algorithm works with an integer base $\beta\geq3$ and an alphabet $\{-a, \dots, 0, \dots a\}$ where $a\in\NN$ is such that $\beta/2 <a \leq \beta-1$. Later, C. Y. Chow and J. E. Robertson presented a parallel addition algorithm for  base 2 and alphabet $\{-1,0,1\}$ in \cite{chow}.

So-called non-standard numeration systems have been extensively studied. Non-standard means that a base is not a positive integer. An example of such system is the Penney numeration system with the base $i-1$ and alphabet $\{0,1\}$. Complex numbers can be represented by this system without separating real and imaginary part. As division algorithms are also developed for non-standard numeration systems, we focus on construction of a parallel addition algorithm.

The numeration system which allow parallel addition must be redundant, i.e, some numbers may have more than one represenation. P.~Kornerup studied how  redundancy is related to parallel addition \cite{kornerup}. 

C. Frougny, E. Pelantov\'a and M. Svobodov\'a provided parallel addition algorithms with an integer alphabet for all bases $\beta$ such that $|\beta|>1$ and no conjugate of $\beta$ equals 1 in modulus, see \cite{parAddNS}. Nevertheless, the alphabet is not minimal in general.
 The parallel addition algorithms for several bases (negative integers, complex numbers $-1+\imath, 2\imath$ and $\sqrt{2}\imath$, quadratic Pisot unit and  non-integer rationals) with minimal integer alphabet are presented in \cite{minAlph}.




\chapter{Preliminaries}

This chapter summarizes definitions related to numeration systems and parallel addition. We recall some known results on properties of a numeration system which allows parallel addition. At the end of the chapter, we define set $\Zomega$ and determine numeration systems within the scope of this thesis.
	\input{preliminaries.tex}




\chapter{Design of extending window method}
\label{chap:ewm}
In this chapter, the general concept of addition and digit set conversion is recalled. We outline a so-called \emph{extending window method} which is due to M. Svobodov\'a \cite{milena}. The method consists of two phases. For a given numeration system $(\beta,\A)$, it attempts to construct a digit set conversion algorithm which is computable in parallel. We recall that $\omega$ is an algebraic integer, $\beta \in \Zomega$ is a base and $0\in\A\subset\Zomega$ is an alphabet. 


	\input{method_description.tex}

\chapter{\texorpdfstring{Properties of $\Zomega$}{Properties of Z[omega]}}
We compile some properties  of the ring $\Zomega$ in this chapter. The isomorphism to $\ZZ^d$ is indicated and used for check of divisibility.  We review some results from matrix theory to introduce a norm in $\Zomega$. This norm is used in the proof of convergence of Phase~1 in Chapter~\ref{chap:convergence}. In the last section of this chapter, we show how the number of congruence classes modulo $\beta$ in $\Zomega$ is determined. That is used in the proof of a lower bound on the size of an alphabet which allows parallel addition in Section~\ref{sec:minimalAlphabet}.
	\input{isomorphism.tex}
	\input{naturalNorm.tex}
	\input{congruenceClasses.tex}	
	
\chapter{Convergence}
We discuss convergence of the extending window method designed in Chapter~\ref{chap:ewm}. We prove a necessary condition of convergence of the whole method and we show that it is also sufficient condition of convergence of Phase~1, using the tools from the previous chapter. Next, we establishes a condition which implies non-convergence of Phase~2. The condition is formulated by existence of an infinite walk in a specific directed graph. We also prove that there is the same lower bound on the size of an alphabet from $\Zbeta$ as for integer alphabets when the extending method converges.
\label{chap:convergence}

	\section{Convergence of Phase 1}
	\input{convergence_Phase1.tex}

	\section{Convergence of Phase 2}
	\input{convergence_Phase2.tex}
	

	\input{lowerBound.tex}


\chapter{Different methods in the extending window method}
	\label{chap:diffChoices}
	We mentioned in Chapter~\ref{chap:ewm} that there is a lot of variability in both phases of the extending window method. Within this chapter, we propose various methods how an intermediate weight coefficients set $\Q_k$ can be extended to $\Q_{k+1}$ in Phase~2 and how the set $\Qwo{k}$ can be constructed in Phase~2. The selection of methods is based on testing many experimental ones. 

	\input{choices_phase1.tex}

	\input{choices_phase2.tex}

	
	


\chapter{Design and implementation}

In the first section of this chapter, we propose algorithms which may reveal non-convergence of Phase~2. They are based on the theorems from Chapter~\ref{chap:convergence}. We present a simple algorithm which makes Phase~2 stable. We develop Algorithm~\ref{alg:weightFunction_modified} that summarizes  Phase~2 with all modifications. All designed algorithms are implemented in SageMath. The program is described in Section~\ref{sec:implementation}.
\label{chap:design}
	\input{modifiedPhase2.tex}
	\input{implementation.tex}

\chapter{Testing}
	\input{testing.tex}

%\chapter*{Summary}
\newpage
\bibliography{literatura}
\addcontentsline{toc}{chapter}{References}
\bibliographystyle{amsplain}

\appendix
\chapter*{Appendices}
\pagenumbering{Roman}
\addcontentsline{toc}{chapter}{Appendices}
\renewcommand{\thesection}{\Alph{section}}
\counterwithin{exmp}{section}
\input{appendix.tex}

\end{document}