In this section, we show that if the extending window method converges, then the base $\beta$ must be expanding, i.e., all its conjugates  are greater than one in modulus. Then we prove that it is also a sufficient condition for convergence of Phase~1.

We use the following notation:
\begin{defn}
Let $\omega$ be a complex number and $\beta \in\Zomega$ be such that $|\beta|>1$. Let $\A\subset \Zomega$ be an alphabet. Set 
$$
\A[\beta]:=\left\{\sum_{i=0}^N a_i \beta^i \colon a_i\in\A, N\in\NN\right\}\,.
$$
\end{defn}

The essential part of the proof that $\beta$ must be expanding is Theorem~\ref{thm:betaExpanding} which is based on the papers of Akiyama, Thuswaldner and ZÃ¤imi \cite{Akiyama201528,Akiyama20131616}.
\begin{thm}\label{thm:betaExpanding}
Let $\omega$ be a complex number and $\beta \in\Zomega$ be such that $|\beta|>1$. Let $\A\subset \Zomega$ be an alphabet. If $\NN\subset \A[\beta]$, then the number $\beta$ is expanding.
\end{thm}
\begin{proof}
For all $n\in\NN$ we may write 
    $$
    n=\sum_{i=0}^{N}a_i\beta^i\,,
    $$
    where $N\in\NN$, $a_i\in\A$ and $a_N\neq 0$.
    
    Set $m:= \max\{|a|\colon a\in\A\}$. We take $n\in\NN$ such that $n>m$. 
    Since $|a_0|\leq m<n$, we have  $N\geq 1$ and there is $i_0 \in \{1,2,\dots,N\}$ such that $a_{i_0}\neq 0$. Thus, $\omega$ is an algebraic number as $a_i\in\A\subset\Zomega$ and $\beta$ can be expressed as an integer combination of powers of $\omega$. Therefore, $\beta$ is also an algebraic number.
    
    Let $\beta'$ be an algebraic conjugate of $\beta$.  
    Since $\beta\in\Zomega\subset\QQ(\omega)$, there is an algebraic conjugate $\omega'$ of $\omega$ and an isomorphism $\sigma: \QQ(\omega)\rightarrow \QQ(\omega')$ such that $\sigma(\beta)=\beta'$. Now 
    $$
    n=\sigma(n)=\sum_{i=0}^{N}\sigma(a_i)(\beta')^i\,.
    $$
    Set $\tilde m:= \max\{|\sigma(a)|\colon a\in\A\}$.  For all $n\in\NN$, we have 
    $$
    n=|n|\leq\sum_{i=0}^{N}|\sigma(a_i)|\cdot|\beta'|^i \leq \sum_{i=0}^{\infty}|\sigma(a_i)|\cdot|\beta'|^i \leq \tilde m\sum_{i=0}^{\infty}|\beta'|^i\,.  
    $$
    Hence, the sum on the right  side diverges which implies that $|\beta'|\geq 1$. Thus, all conjugates of $\beta$ are at least one in modulus.
    
    If the degree of $\beta$ is one, the statement is obvious.  Therefore, we may assume that $\deg \beta \geq 2$. 
    
    Suppose  for contradiction that $|\beta'|=1$ for an algebraic conjugate $\beta'$  of $\beta$. The complex conjugate $\overline{\beta'}$ is also an algebraic conjugate of $\beta$. Take any algebraic conjugate $\gamma$ of $\beta$ and the isomorphism $\sigma': \QQ(\beta')\rightarrow \QQ(\gamma)$ given by $\sigma'(\beta')=\gamma$.
    Now
    $$
    \frac{1}{\gamma}=\frac{1}{\sigma'(\beta')}=\sigma'\left(\frac{1}{\beta'}\right)=\sigma'\left(\frac{\overline{\beta'}}{\beta'\overline{\beta'}}\right)=\sigma'\left(\frac{\overline{\beta'}}{|\beta'|^2}\right)=\sigma'(\overline{\beta'})\,.
    $$
    Hence, $\frac{1}{\gamma}$ is also an algebraic conjugate of $\beta$. Moreover, $\left|\frac{1}{\gamma}\right|\geq 1$ and $|\gamma|\geq 1$ which implies that $|\gamma|=1$. We may set $\gamma=\beta$ which contradicts $|\beta|>1$. Thus all conjugates of $\beta$ are greater than one in modulus, i.e., $\beta$ is an expanding algebraic number.
\end{proof}


Now we can easily prove that existence of a parallel addition algorithm with the rewriting rule $x-\beta$ implies that $\beta$ is expanding.
\begin{thm}
Let $\A\subset \Zomega$ be an alphabet such that $1\in \A[\beta]$. If the extending window method with the rewriting rule $x-\beta$ converges for the numeration system $(\beta, \A)$, then the base $\beta$ is expanding. 
\end{thm}
\begin{proof}
The existence of an algorithm for addition which is computable in parallel implies that the set $\fin{\A}$ is closed under addition. Moreover, the set $\A[\beta]$ is closed under addition since there is no carry to the right when the rewriting rule $x-\beta$ is used. For any $n\in\NN$, the sum $1+1+\cdots +1=n$ is in $\A[\beta]$ by the assumption $1\in \A[\beta]$. Therefore, $\NN\subset \A[\beta]$ and thus the base $\beta$ is expanding by Theorem~\ref{thm:betaExpanding}.
\end{proof}


Since we know that it makes sense to consider only expanding base, we may ask if Phase~1 converges for such a base. The answer is positive, with some natural assumption on the alphabet $\A$. The following lemma provides a finite set of weight coefficients $\Q$. 
\begin{lem}
\label{lem:suffCondPhase1}
    Let $\omega$ be an algebraic integer, $\deg \omega=d$, and $\beta$ be an expanding algebraic integer in $\Zomega$. Let $\A$ and $\B$ be finite subsets of $\Zomega$ such that $\A$ contains at least one representative of each congruence class modulo $\beta$ in $\Zomega$. There exists a finite set $\Q\subset\Zomega$  such that $ \B + \Q \subset \A + \beta \Q$.
\end{lem}

\begin{proof}
We use the isomorphism $\pi:\Zomega \rightarrow \ZZ^{d}$ and $\beta$-norm $\normBeta{\cdot}$ to give a bound on the elements of $\Zomega$.
Let $\gamma$ be the smallest conjugate of $\beta$ in modulus. 
 Denote $C:=\max\{\normBeta{b-a}\colon a \in \A, b \in \B\}$. Consequently, set $R:=\frac{C}{|\gamma|-1}$ and $\Q:=\{q\in\Zomega\colon \normBeta{q}\leq R\}$. By Lemma~\ref{lem:propertiesSbeta}, we have 
 $$
 \Mnorm{S_\beta^{-1}}{S_\beta}=\max \{\frac{1}{|\beta'|} \colon \beta' \text{ is conjugate of } \beta\}=\frac{1}{|\gamma|}\,.
 $$ 
 Also, $|\gamma|>1$ as $\beta$ is an expanding integer.  Since $C>0$, the set $\Q$ is nonempty. Any element $x=b+q \in \Zomega$ with $b\in\B$ and $q\in\Q$ can be written as $x=a+\beta q'$ for some $a\in\A$  and $q'\in\Zomega$ due to existence of a representative of each congruence class in $\A$. Using the isomorphism $\pi$, we may write $\pi(q')=S^{-1}_\beta \cdot \pi(b-a+q)$. We prove that $q'$ is in $\Q$:
\begin{align*}
    \normBeta{q'}&=\norm{\pi\left(q'\right)}{S_\beta}=\norm{S^{-1}_\beta \cdot \pi\left(b-a+q\right)}{S_\beta}\leq \Mnorm{S^{-1}_\beta}{S_\beta}  \normBeta{b-a+q} \\
    &\leq  \frac{1}{|\gamma|} \left(\normBeta{b-a} +\normBeta{q}\right)=\frac{1}{|\gamma|} \left(C+R\right)=\frac{C}{|\gamma|} \left(1+\frac{1}{|\gamma|-1}\right) =R\,.
\end{align*}
 
 Hence $q'\in\Q$ and thus  $x=b+q \in \A + \beta \Q$. 
 
 Since there are only finitely many elements of $\ZZ^{d}$ bounded by the constant $R$, the set $\Q$ is finite.
\end{proof}


The way how candidates for the weight coefficients are chosen in Algorithm~\ref{alg:searchCand} is the same as in the proof of Lemma~\ref{lem:suffCondPhase1}. Therefore, the convergence of Phase~1 is guaranteed by the following theorem.
\begin{thm}
\label{thm:suffCondPhase1}
Let $\omega$ be an algebraic integer and $\beta\in\Zomega$. Let the alphabet $\A\subset\Zomega$ be such that $\A$ contains at least one representative of each congruence class modulo $\beta$ in $\Zomega$. Let $\B\subset\Zomega$ be the input alphabet. 

If $\beta$ is expanding, then Phase 1 of the extending window method converges.
\end{thm}
\begin{proof}
Let $R$ be a constant and $\Q$ be a finite set from Lemma \ref{lem:suffCondPhase1} for the alphabet $\A$ and input alphabet $\B$. We prove by induction that  all intermediate weight coefficient sets $\Q_k$ in Algorithm \ref{alg:weightCoefSet} are subsets of the finite set $\Q$. 

We start with $\Q_0=\{0\}$ whose elements are bounded by any positive constant. Suppose that the intermediate weight coefficients set $\Q_k$ has elements bounded by the constant $R$. We see from the previous  proof that the candidates obtained by Algorithm \ref{alg:searchCand} for the set $\Q_k$ are also bounded by $R$. Thus, the next intermediate weight coefficients set $\Q_{k+1}$ has elements bounded by the constant $R$, i.e., $\Q_{k+1}\subset\Q$. 

Since $\#\Q$ is finite and $\Q_0\subset\Q_1\subset\Q_2\subset\cdots\subset\Q$,  Phase 1 successfully ends. 
\end{proof}

%\komentar{shrnuti takhle???: (pouziva vety z dalsi sekce!!)}
%\begin{thm}
%Let $\beta$ be an algebraic integer such that $|\beta|>1$. Let $0\in \A\subset \Zbeta$ be an alphabet such that $1\in \A[\beta]$. If the extending window method finds an algorithm for parallel addition in the numeration system $(\beta, \A)$, then the alphabet $\A$ contains at least one representative of each congruence class modulo $\beta$ and $\beta-1$ in $\Zbeta$, and the base $\beta$ is expanding. Moreover, if the  alphabet $\A$ contains at least one representative of each congruence class modulo $\beta$ and the base $\beta$ is expanding, then Phase 1 of the extending window method converges.
%\end{thm}
